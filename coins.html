<!DOCTYPE html>
<html>
<head>

<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
<link href="./coins.css" rel="stylesheet" type="text/css"/>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
<!--<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
-->

<script>

	var chipsValues = new Array(1, 2, 5, 10);
	var players = 4;
	var turn = -1;
	
	var nextPlayer = function() {
		turn += 1;
		turn %= players;
		
		// repaint homefield-marker
		$(".ablage").css("border", "");
		$(".ablage").eq(turn).css("border", "3px dotted blue");
		
		// repaint draggable-property
		$(".coin[owner!=" + turn + "]").draggable( "option", "disabled", true );
		$(".coin[owner =" + turn + "]").draggable( "option", "disabled", false );
		
	}
	
	var generateUniverse = function()  { 
	
		// pott
		$('<div/>', { class: 'pott' } ).appendTo("body");
		$(".pott").droppable({
			drop: function( event, ui ) {
				$(this).addClass( "ui-state-highlight" ).html( "Dropped!" );
			}
		});		
		
		// homefields
		for (var player = 0; player < players; player++) {
			$('<div/>', { class: 'ablage', owner: player } ).appendTo("body");
		}
		$(".ablage").each(function(i) {
			$(this).append( i+1 );
			$(this).css("left", ((i*25)+2.5)+"%");
		});

		// coins
		for (var player = 0; player < players; player++) {
			for (var i = 0; i < chipsValues.length; i++) {
				for (var j = 1; j < 10; j++) {
					var coin = $('<div/>', { class: 'coin', owner: player, amount: chipsValues[i]} );
					coin.appendTo("body");
				}
			}
		}
		$(".coin").draggable({ disabled: true, revert: 'invalid' });

		// next-button
		$('<div/>', {id: 'weiter',text: 'weiter', onClick: 'nextPlayer()', class: 'clickable' }).appendTo($('body'));
	}

	
	// ebay, immoscou, Tel.Augusta, KabelDeut., comdirect, 
	
	
	var replaceChips = function() {
		for (var player = 0; player < players; player++) {
			for (var j = 0; j < chipsValues.length; j++) {
				$(".coin[owner=" + player +"][amount=" + chipsValues[j] + "]").each(function(i) {
					$(this).css("bottom", (i*10 + Math.floor(i/5)*6 +24) + "px");
					$(this).css("left", ($(this).attr("owner")*25 + chipsValues.indexOf(parseInt($(this).attr("amount")))*3 + 4) + "%");
				});
			}
		}	
	}

	$(document).ready(function() {	
		generateUniverse();
		replaceChips();
		nextPlayer();
	});
	
	
</script>

</head>
<body></body>
</html>


